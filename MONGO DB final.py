Python 3.6.2 (v3.6.2:5fd33b5, Jul  8 2017, 04:57:36) [MSC v.1900 64 bit (AMD64)] on win32
Type "copyright", "credits" or "license()" for more information.
>>> import pymongo
>>> import pandas as pd
>>> import spacy
Traceback (most recent call last):
  File "<pyshell#2>", line 1, in <module>
    import spacy
ModuleNotFoundError: No module named 'spacy'
>>> import re
>>> from sklearn import model_selection, preprocessing, linear_model, naive_bayes, metrics, svm
>>> from sklearn.feature_extraction.text import TfidfVectorizer, CountVectorizer
>>> from sklearn import decomposition, ensemble

>>> import pandas, xgboost, numpy, textblob, string
>>> from keras.preprocessing import text, sequence
Using TensorFlow backend.
>>> from keras import layers, models, optimizers
>>> myc = pymongo.MongoClient("mongodb://localhost:27017/")
>>> db = myc["test123"]
>>> print("Database names available in mongodb",myc.list_database_names())
Database names available in mongodb ['admin', 'config', 'local']
>>> data = mydb.get_collection('test')
Traceback (most recent call last):
  File "<pyshell#13>", line 1, in <module>
    data = mydb.get_collection('test')
NameError: name 'mydb' is not defined
>>> data = db.get_collection('test')
>>> str(data.count())
'0'
>>> data = myc["admin"]
>>> db = myc["admin"]
>>> data = db.get_collection('test')
>>> str(data.count())
'124432'
>>> cursor = db['test']
>>> cursor = db['test'].find()
>>> df = pd.DataFrame(list(cursor))
>>> print(df)
                                    "product_description" "product_uid"                       _id
0                "Not only do angles make joints stronger        100001  5c65d6fb301e902e14e36b73
1       "BEHR Premium Textured DECKOVER is an innovati...        100002  5c65d6fb301e902e14e36b74
2       "Classic architecture meets contemporary desig...        100003  5c65d6fb301e902e14e36b75
3       "The Grape Solar 265-Watt Polycrystalline PV S...        100004  5c65d6fb301e902e14e36b76
4       "Update your bathroom with the Delta Vero Sing...        100005  5c65d6fb301e902e14e36b77
5       "Achieving delicious results is almost effortl...        100006  5c65d6fb301e902e14e36b78
6       "The Quantum Adjustable 2-Light LED Black Emer...        100007  5c65d6fb301e902e14e36b79
7       "The Teks #10 x 1-1/2 in. Zinc-Plated Steel Wa...        100008  5c65d6fb301e902e14e36b7a
8       "Get the House of Fara 3/4 in. x 3 in. x 8 ft....        100009  5c65d6fb301e902e14e36b7b
9       "Valley View Industries Metal Stakes (4-Pack) ...        100010  5c65d6fb301e902e14e36b7c
10      "Recycler 22 in. Personal Pace Variable Speed ...        100011  5c65d6fb301e902e14e36b7d
11      "The 96 in. wide Caramel Simple Weave Rollup B...        100012  5c65d6fb301e902e14e36b7e
12      "The InSinkErator SinkTop Switch Single Outlet...        100013  5c65d6fb301e902e14e36b7f
13      "The Rubbermaid 1-Step Folding Plastic Step St...        100014  5c65d6fb301e902e14e36b80
14                                     "Backyard X-Scapes        100015  5c65d6fb301e902e14e36b81
15      "Make grilling great with this handsome and fu...        100016  5c65d6fb301e902e14e36b82
16      "The MD Building Products 36 in. x 36 in. x 1/...        100017  5c65d6fb301e902e14e36b83
17      "This classic plastic sprinkler head that fits...        100018  5c65d6fb301e902e14e36b84
18      "The House of Fara 8 Linear ft. primed MDF Ove...        100019  5c65d6fb301e902e14e36b85
19      "These unique LED multi-color sticks are sure ...        100020  5c65d6fb301e902e14e36b86
20      "Installed in parks and backyards across the g...        100021  5c65d6fb301e902e14e36b87
21      "The Samsung 4.2 cu. ft. Front Load Washer wit...        100022  5c65d6fb301e902e14e36b88
22      "Quikrete 80 lb. Crack-Resistant Concrete is d...        100023  5c65d6fb301e902e14e36b89
23      "From Smartphones to refrigerators and everyth...        100024  5c65d6fb301e902e14e36b8a
24      "Save your back and make moving easier with th...        100025  5c65d6fb301e902e14e36b8b
25      "Our 10 ft. x 10 ft. (100 sq. ft.) Yorkstone p...        100026  5c65d6fb301e902e14e36b8c
26      "The UltraTouch 48 in. x 24 ft. Radiant Barrie...        100027  5c65d6fb301e902e14e36b8d
27      "Reed fencing is a convenient and cost effecti...        100028  5c65d6fb301e902e14e36b8e
28                                   "Achieving a vintage        100029  5c65d6fb301e902e14e36b8f
29      "White Designer Shelf Brackets offer a stylish...        100030  5c65d6fb301e902e14e36b90
...                                                   ...           ...                       ...
124402  "The Eaton CSR 200-Amp Double-Pole Main Breake...        224400  5c65d709301e902e14e55165
124403  "These push nuts have no screw thread but have...        224401  5c65d709301e902e14e55166
124404  "The Dickies Utility Knife Sheath is construct...        224402  5c65d709301e902e14e55167
124405                         "Carefree resin durability        224403  5c65d709301e902e14e55168
124406  "The Speakman branded emergency eyewash safety...        224404  5c65d709301e902e14e55169
124407  "The PL-65111-01 is a Plantronics phone access...        224405  5c65d709301e902e14e5516a
124408  "The 1940's are back with a hint of today. Ava...        224406  5c65d709301e902e14e5516b
124409  "Step up to designer styles and superior secur...        224407  5c65d709301e902e14e5516c
124410  "1/2 in. x 100 ft. IPS 125 psi NSF Poly Pipe i...        224408  5c65d709301e902e14e5516d
124411  "Enjoy optimal viewing areas with the Magnavox...        224409  5c65d709301e902e14e5516e
124412  "Beautiful crown moulding is a great way to se...        224410  5c65d709301e902e14e5516f
124413  "Minwax Polycrylic Protective Finish is a prot...        224411  5c65d709301e902e14e55170
124414  "The Pink Stella Camellia from the Southern Li...        224412  5c65d709301e902e14e55171
124415  "Your GE 30 in. 5.0 cu. ft. Gas Range with Sel...        224413  5c65d709301e902e14e55172
124416  "Southwires Submersible Pump cable is used sub...        224414  5c65d709301e902e14e55173
124417  "Generacs new Protector Series diesel generato...        224415  5c65d709301e902e14e55174
124418  "The Clearflo Brass Toe-tap bath drain works p...        224416  5c65d709301e902e14e55175
124419  "The Light Kit by Casablanca is a great design...        224417  5c65d709301e902e14e55176
124420  "The Glidden Premium 5-gal. Satin Latex Exteri...        224418  5c65d709301e902e14e55177
124421                     "Paracord is ideal for camping        224419  5c65d709301e902e14e55178
124422  "Crown Bolt's shoulder bolts are also known as...        224420  5c65d709301e902e14e55179
124423  "Wheel Chair Accessible's provide a safe and i...        224421  5c65d709301e902e14e5517a
124424  "These wood screws are thread forming screws w...        224422  5c65d709301e902e14e5517b
124425  "The Legend Series framed swing stand-alone co...        224423  5c65d709301e902e14e5517c
124426  "Create a neat yet stylish storage space for o...        224424  5c65d709301e902e14e5517d
124427  "Our Bullnose Adirondack Chair Cushions fit Ad...        224425  5c65d709301e902e14e5517e
124428  "Joist hangers are designed to provide support...        224426  5c65d709301e902e14e5517f
124429  "These socket cap screws are ideal for applica...        224427  5c65d709301e902e14e55180
124430  "The Bosch quick change bi-metal hole saws fea...        224428  5c65d709301e902e14e55181
124431                                               None                5c65d709301e902e14e55182

[124432 rows x 3 columns]
>>> df= df['"product_description"']
>>> print(df)
0                  "Not only do angles make joints stronger
1         "BEHR Premium Textured DECKOVER is an innovati...
2         "Classic architecture meets contemporary desig...
3         "The Grape Solar 265-Watt Polycrystalline PV S...
4         "Update your bathroom with the Delta Vero Sing...
5         "Achieving delicious results is almost effortl...
6         "The Quantum Adjustable 2-Light LED Black Emer...
7         "The Teks #10 x 1-1/2 in. Zinc-Plated Steel Wa...
8         "Get the House of Fara 3/4 in. x 3 in. x 8 ft....
9         "Valley View Industries Metal Stakes (4-Pack) ...
10        "Recycler 22 in. Personal Pace Variable Speed ...
11        "The 96 in. wide Caramel Simple Weave Rollup B...
12        "The InSinkErator SinkTop Switch Single Outlet...
13        "The Rubbermaid 1-Step Folding Plastic Step St...
14                                       "Backyard X-Scapes
15        "Make grilling great with this handsome and fu...
16        "The MD Building Products 36 in. x 36 in. x 1/...
17        "This classic plastic sprinkler head that fits...
18        "The House of Fara 8 Linear ft. primed MDF Ove...
19        "These unique LED multi-color sticks are sure ...
20        "Installed in parks and backyards across the g...
21        "The Samsung 4.2 cu. ft. Front Load Washer wit...
22        "Quikrete 80 lb. Crack-Resistant Concrete is d...
23        "From Smartphones to refrigerators and everyth...
24        "Save your back and make moving easier with th...
25        "Our 10 ft. x 10 ft. (100 sq. ft.) Yorkstone p...
26        "The UltraTouch 48 in. x 24 ft. Radiant Barrie...
27        "Reed fencing is a convenient and cost effecti...
28                                     "Achieving a vintage
29        "White Designer Shelf Brackets offer a stylish...
                                ...                        
124402    "The Eaton CSR 200-Amp Double-Pole Main Breake...
124403    "These push nuts have no screw thread but have...
124404    "The Dickies Utility Knife Sheath is construct...
124405                           "Carefree resin durability
124406    "The Speakman branded emergency eyewash safety...
124407    "The PL-65111-01 is a Plantronics phone access...
124408    "The 1940's are back with a hint of today. Ava...
124409    "Step up to designer styles and superior secur...
124410    "1/2 in. x 100 ft. IPS 125 psi NSF Poly Pipe i...
124411    "Enjoy optimal viewing areas with the Magnavox...
124412    "Beautiful crown moulding is a great way to se...
124413    "Minwax Polycrylic Protective Finish is a prot...
124414    "The Pink Stella Camellia from the Southern Li...
124415    "Your GE 30 in. 5.0 cu. ft. Gas Range with Sel...
124416    "Southwires Submersible Pump cable is used sub...
124417    "Generacs new Protector Series diesel generato...
124418    "The Clearflo Brass Toe-tap bath drain works p...
124419    "The Light Kit by Casablanca is a great design...
124420    "The Glidden Premium 5-gal. Satin Latex Exteri...
124421                       "Paracord is ideal for camping
124422    "Crown Bolt's shoulder bolts are also known as...
124423    "Wheel Chair Accessible's provide a safe and i...
124424    "These wood screws are thread forming screws w...
124425    "The Legend Series framed swing stand-alone co...
124426    "Create a neat yet stylish storage space for o...
124427    "Our Bullnose Adirondack Chair Cushions fit Ad...
124428    "Joist hangers are designed to provide support...
124429    "These socket cap screws are ideal for applica...
124430    "The Bosch quick change bi-metal hole saws fea...
124431                                                 None
Name: "product_description", Length: 124432, dtype: object
>>> texts , labels = [],[]
>>> for i,line in enumerate(data.split("\n")):
	content = line.split()
	labels.append(content[0])
	texts.append(" ".join(content[1:]))

	
Traceback (most recent call last):
  File "<pyshell#33>", line 1, in <module>
    for i,line in enumerate(data.split("\n")):
  File "C:\Users\kupatel\AppData\Local\Programs\Python\Python36-32\nlpkush\lib\site-packages\pymongo\collection.py", line 3321, in __call__
    self.__name.split(".")[-1])
TypeError: 'Collection' object is not callable. If you meant to call the 'split' method on a 'Collection' object it is failing because no such method exists.
>>> type(df)
<class 'pandas.core.series.Series'>
>>> data = str(df)
>>> print(data)
0                  "Not only do angles make joints stronger
1         "BEHR Premium Textured DECKOVER is an innovati...
2         "Classic architecture meets contemporary desig...
3         "The Grape Solar 265-Watt Polycrystalline PV S...
4         "Update your bathroom with the Delta Vero Sing...
5         "Achieving delicious results is almost effortl...
6         "The Quantum Adjustable 2-Light LED Black Emer...
7         "The Teks #10 x 1-1/2 in. Zinc-Plated Steel Wa...
8         "Get the House of Fara 3/4 in. x 3 in. x 8 ft....
9         "Valley View Industries Metal Stakes (4-Pack) ...
10        "Recycler 22 in. Personal Pace Variable Speed ...
11        "The 96 in. wide Caramel Simple Weave Rollup B...
12        "The InSinkErator SinkTop Switch Single Outlet...
13        "The Rubbermaid 1-Step Folding Plastic Step St...
14                                       "Backyard X-Scapes
15        "Make grilling great with this handsome and fu...
16        "The MD Building Products 36 in. x 36 in. x 1/...
17        "This classic plastic sprinkler head that fits...
18        "The House of Fara 8 Linear ft. primed MDF Ove...
19        "These unique LED multi-color sticks are sure ...
20        "Installed in parks and backyards across the g...
21        "The Samsung 4.2 cu. ft. Front Load Washer wit...
22        "Quikrete 80 lb. Crack-Resistant Concrete is d...
23        "From Smartphones to refrigerators and everyth...
24        "Save your back and make moving easier with th...
25        "Our 10 ft. x 10 ft. (100 sq. ft.) Yorkstone p...
26        "The UltraTouch 48 in. x 24 ft. Radiant Barrie...
27        "Reed fencing is a convenient and cost effecti...
28                                     "Achieving a vintage
29        "White Designer Shelf Brackets offer a stylish...
                                ...                        
124402    "The Eaton CSR 200-Amp Double-Pole Main Breake...
124403    "These push nuts have no screw thread but have...
124404    "The Dickies Utility Knife Sheath is construct...
124405                           "Carefree resin durability
124406    "The Speakman branded emergency eyewash safety...
124407    "The PL-65111-01 is a Plantronics phone access...
124408    "The 1940's are back with a hint of today. Ava...
124409    "Step up to designer styles and superior secur...
124410    "1/2 in. x 100 ft. IPS 125 psi NSF Poly Pipe i...
124411    "Enjoy optimal viewing areas with the Magnavox...
124412    "Beautiful crown moulding is a great way to se...
124413    "Minwax Polycrylic Protective Finish is a prot...
124414    "The Pink Stella Camellia from the Southern Li...
124415    "Your GE 30 in. 5.0 cu. ft. Gas Range with Sel...
124416    "Southwires Submersible Pump cable is used sub...
124417    "Generacs new Protector Series diesel generato...
124418    "The Clearflo Brass Toe-tap bath drain works p...
124419    "The Light Kit by Casablanca is a great design...
124420    "The Glidden Premium 5-gal. Satin Latex Exteri...
124421                       "Paracord is ideal for camping
124422    "Crown Bolt's shoulder bolts are also known as...
124423    "Wheel Chair Accessible's provide a safe and i...
124424    "These wood screws are thread forming screws w...
124425    "The Legend Series framed swing stand-alone co...
124426    "Create a neat yet stylish storage space for o...
124427    "Our Bullnose Adirondack Chair Cushions fit Ad...
124428    "Joist hangers are designed to provide support...
124429    "These socket cap screws are ideal for applica...
124430    "The Bosch quick change bi-metal hole saws fea...
124431                                                 None
Name: "product_description", Length: 124432, dtype: object
>>> type(data)
<class 'str'>
>>> for i,line in enumerate(data.split("\n")):
	content = line.split()
	labels.append(content[0])
	texts.append(" ".join(content[1:]))

	
>>> print(data)
0                  "Not only do angles make joints stronger
1         "BEHR Premium Textured DECKOVER is an innovati...
2         "Classic architecture meets contemporary desig...
3         "The Grape Solar 265-Watt Polycrystalline PV S...
4         "Update your bathroom with the Delta Vero Sing...
5         "Achieving delicious results is almost effortl...
6         "The Quantum Adjustable 2-Light LED Black Emer...
7         "The Teks #10 x 1-1/2 in. Zinc-Plated Steel Wa...
8         "Get the House of Fara 3/4 in. x 3 in. x 8 ft....
9         "Valley View Industries Metal Stakes (4-Pack) ...
10        "Recycler 22 in. Personal Pace Variable Speed ...
11        "The 96 in. wide Caramel Simple Weave Rollup B...
12        "The InSinkErator SinkTop Switch Single Outlet...
13        "The Rubbermaid 1-Step Folding Plastic Step St...
14                                       "Backyard X-Scapes
15        "Make grilling great with this handsome and fu...
16        "The MD Building Products 36 in. x 36 in. x 1/...
17        "This classic plastic sprinkler head that fits...
18        "The House of Fara 8 Linear ft. primed MDF Ove...
19        "These unique LED multi-color sticks are sure ...
20        "Installed in parks and backyards across the g...
21        "The Samsung 4.2 cu. ft. Front Load Washer wit...
22        "Quikrete 80 lb. Crack-Resistant Concrete is d...
23        "From Smartphones to refrigerators and everyth...
24        "Save your back and make moving easier with th...
25        "Our 10 ft. x 10 ft. (100 sq. ft.) Yorkstone p...
26        "The UltraTouch 48 in. x 24 ft. Radiant Barrie...
27        "Reed fencing is a convenient and cost effecti...
28                                     "Achieving a vintage
29        "White Designer Shelf Brackets offer a stylish...
                                ...                        
124402    "The Eaton CSR 200-Amp Double-Pole Main Breake...
124403    "These push nuts have no screw thread but have...
124404    "The Dickies Utility Knife Sheath is construct...
124405                           "Carefree resin durability
124406    "The Speakman branded emergency eyewash safety...
124407    "The PL-65111-01 is a Plantronics phone access...
124408    "The 1940's are back with a hint of today. Ava...
124409    "Step up to designer styles and superior secur...
124410    "1/2 in. x 100 ft. IPS 125 psi NSF Poly Pipe i...
124411    "Enjoy optimal viewing areas with the Magnavox...
124412    "Beautiful crown moulding is a great way to se...
124413    "Minwax Polycrylic Protective Finish is a prot...
124414    "The Pink Stella Camellia from the Southern Li...
124415    "Your GE 30 in. 5.0 cu. ft. Gas Range with Sel...
124416    "Southwires Submersible Pump cable is used sub...
124417    "Generacs new Protector Series diesel generato...
124418    "The Clearflo Brass Toe-tap bath drain works p...
124419    "The Light Kit by Casablanca is a great design...
124420    "The Glidden Premium 5-gal. Satin Latex Exteri...
124421                       "Paracord is ideal for camping
124422    "Crown Bolt's shoulder bolts are also known as...
124423    "Wheel Chair Accessible's provide a safe and i...
124424    "These wood screws are thread forming screws w...
124425    "The Legend Series framed swing stand-alone co...
124426    "Create a neat yet stylish storage space for o...
124427    "Our Bullnose Adirondack Chair Cushions fit Ad...
124428    "Joist hangers are designed to provide support...
124429    "These socket cap screws are ideal for applica...
124430    "The Bosch quick change bi-metal hole saws fea...
124431                                                 None
Name: "product_description", Length: 124432, dtype: object
>>> trainDF = pandas.DataFrame()
>>> trainDF['text'] = texts
>>> trainDF['label'] = labels
>>> train_x, valid_x, train_y, valid_y = model_selection.train_test_split(trainDF['text'], trainDF['label'])
>>> print(train_x)
30                                                     
42    "Minwax Polycrylic Protective Finish is a prot...
49    "The Glidden Premium 5-gal. Satin Latex Exteri...
55    "Create a neat yet stylish storage space for o...
44    "Your GE 30 in. 5.0 cu. ft. Gas Range with Sel...
10    "Recycler 22 in. Personal Pace Variable Speed ...
20    "Installed in parks and backyards across the g...
25    "Our 10 ft. x 10 ft. (100 sq. ft.) Yorkstone p...
27    "Reed fencing is a convenient and cost effecti...
38    "Step up to designer styles and superior secur...
15    "Make grilling great with this handsome and fu...
48    "The Light Kit by Casablanca is a great design...
47    "The Clearflo Brass Toe-tap bath drain works p...
33    "The Dickies Utility Knife Sheath is construct...
59    "The Bosch quick change bi-metal hole saws fea...
21    "The Samsung 4.2 cu. ft. Front Load Washer wit...
14                                   "Backyard X-Scapes
22    "Quikrete 80 lb. Crack-Resistant Concrete is d...
28                                 "Achieving a vintage
51    "Crown Bolt's shoulder bolts are also known as...
16    "The MD Building Products 36 in. x 36 in. x 1/...
61    "product_description", Length: 124432, dtype: ...
4     "Update your bathroom with the Delta Vero Sing...
32    "These push nuts have no screw thread but have...
13    "The Rubbermaid 1-Step Folding Plastic Step St...
1     "BEHR Premium Textured DECKOVER is an innovati...
46    "Generacs new Protector Series diesel generato...
17    "This classic plastic sprinkler head that fits...
11    "The 96 in. wide Caramel Simple Weave Rollup B...
5     "Achieving delicious results is almost effortl...
3     "The Grape Solar 265-Watt Polycrystalline PV S...
45    "Southwires Submersible Pump cable is used sub...
53    "These wood screws are thread forming screws w...
34                           "Carefree resin durability
7     "The Teks #10 x 1-1/2 in. Zinc-Plated Steel Wa...
52    "Wheel Chair Accessible's provide a safe and i...
41    "Beautiful crown moulding is a great way to se...
12    "The InSinkErator SinkTop Switch Single Outlet...
35    "The Speakman branded emergency eyewash safety...
39    "1/2 in. x 100 ft. IPS 125 psi NSF Poly Pipe i...
58    "These socket cap screws are ideal for applica...
56    "Our Bullnose Adirondack Chair Cushions fit Ad...
43    "The Pink Stella Camellia from the Southern Li...
26    "The UltraTouch 48 in. x 24 ft. Radiant Barrie...
40    "Enjoy optimal viewing areas with the Magnavox...
0              "Not only do angles make joints stronger
Name: text, dtype: object
>>> print(train_y)
30       ...
42    124413
49    124420
55    124426
44    124415
10        10
20        20
25        25
27        27
38    124409
15        15
48    124419
47    124418
33    124404
59    124430
21        21
14        14
22        22
28        28
51    124422
16        16
61     Name:
4          4
32    124403
13        13
1          1
46    124417
17        17
11        11
5          5
3          3
45    124416
53    124424
34    124405
7          7
52    124423
41    124412
12        12
35    124406
39    124410
58    124429
56    124427
43    124414
26        26
40    124411
0          0
Name: label, dtype: object
>>> print(valid_x)
19    "These unique LED multi-color sticks are sure ...
31    "The Eaton CSR 200-Amp Double-Pole Main Breake...
18    "The House of Fara 8 Linear ft. primed MDF Ove...
37    "The 1940's are back with a hint of today. Ava...
29    "White Designer Shelf Brackets offer a stylish...
8     "Get the House of Fara 3/4 in. x 3 in. x 8 ft....
57    "Joist hangers are designed to provide support...
36    "The PL-65111-01 is a Plantronics phone access...
60                                                 None
2     "Classic architecture meets contemporary desig...
50                       "Paracord is ideal for camping
23    "From Smartphones to refrigerators and everyth...
9     "Valley View Industries Metal Stakes (4-Pack) ...
54    "The Legend Series framed swing stand-alone co...
24    "Save your back and make moving easier with th...
6     "The Quantum Adjustable 2-Light LED Black Emer...
Name: text, dtype: object
>>> print(valid_y)
19        19
31    124402
18        18
37    124408
29        29
8          8
57    124428
36    124407
60    124431
2          2
50    124421
23        23
9          9
54    124425
24        24
6          6
Name: label, dtype: object
>>> encoder  preprocessing.LabelEncoder()
SyntaxError: invalid syntax
>>> encoder = preprocessing.LabelEncoder()
>>> train_y = encoder.fit_transform(train_y)
>>> valid_y  = encoder.fit_tranform(valid_y)
Traceback (most recent call last):
  File "<pyshell#52>", line 1, in <module>
    valid_y  = encoder.fit_tranform(valid_y)
AttributeError: 'LabelEncoder' object has no attribute 'fit_tranform'
>>> valid_y = encoder.fit_transform(valid_y)
>>> print(train_y)
[ 0 14 21 25 16  3 34 37 39 10 31 20 19  7 28 35 30 36 40 22 32 45 42  6
 29  2 18 33  4 43 41 17 24  8 44 23 13  5  9 11 27 26 15 38 12  1]
>>> print(valid_y)
[ 8  0  7  2 12 14  5  1  6  9  3 10 15  4 11 13]
>>> import numpy as np
>>> import spacy
Traceback (most recent call last):
  File "<pyshell#57>", line 1, in <module>
    import spacy
ModuleNotFoundError: No module named 'spacy'
>>> import spact
Traceback (most recent call last):
  File "<pyshell#58>", line 1, in <module>
    import spact
ModuleNotFoundError: No module named 'spact'
>>> import spacy
Traceback (most recent call last):
  File "<pyshell#59>", line 1, in <module>
    import spacy
ModuleNotFoundError: No module named 'spacy'
>>> import re
>>> import time
>>> import pickle
>>> train.shape
Traceback (most recent call last):
  File "<pyshell#63>", line 1, in <module>
    train.shape
NameError: name 'train' is not defined
>>> trainDF['text']
0              "Not only do angles make joints stronger
1     "BEHR Premium Textured DECKOVER is an innovati...
2     "Classic architecture meets contemporary desig...
3     "The Grape Solar 265-Watt Polycrystalline PV S...
4     "Update your bathroom with the Delta Vero Sing...
5     "Achieving delicious results is almost effortl...
6     "The Quantum Adjustable 2-Light LED Black Emer...
7     "The Teks #10 x 1-1/2 in. Zinc-Plated Steel Wa...
8     "Get the House of Fara 3/4 in. x 3 in. x 8 ft....
9     "Valley View Industries Metal Stakes (4-Pack) ...
10    "Recycler 22 in. Personal Pace Variable Speed ...
11    "The 96 in. wide Caramel Simple Weave Rollup B...
12    "The InSinkErator SinkTop Switch Single Outlet...
13    "The Rubbermaid 1-Step Folding Plastic Step St...
14                                   "Backyard X-Scapes
15    "Make grilling great with this handsome and fu...
16    "The MD Building Products 36 in. x 36 in. x 1/...
17    "This classic plastic sprinkler head that fits...
18    "The House of Fara 8 Linear ft. primed MDF Ove...
19    "These unique LED multi-color sticks are sure ...
20    "Installed in parks and backyards across the g...
21    "The Samsung 4.2 cu. ft. Front Load Washer wit...
22    "Quikrete 80 lb. Crack-Resistant Concrete is d...
23    "From Smartphones to refrigerators and everyth...
24    "Save your back and make moving easier with th...
25    "Our 10 ft. x 10 ft. (100 sq. ft.) Yorkstone p...
26    "The UltraTouch 48 in. x 24 ft. Radiant Barrie...
27    "Reed fencing is a convenient and cost effecti...
28                                 "Achieving a vintage
29    "White Designer Shelf Brackets offer a stylish...
                            ...                        
32    "These push nuts have no screw thread but have...
33    "The Dickies Utility Knife Sheath is construct...
34                           "Carefree resin durability
35    "The Speakman branded emergency eyewash safety...
36    "The PL-65111-01 is a Plantronics phone access...
37    "The 1940's are back with a hint of today. Ava...
38    "Step up to designer styles and superior secur...
39    "1/2 in. x 100 ft. IPS 125 psi NSF Poly Pipe i...
40    "Enjoy optimal viewing areas with the Magnavox...
41    "Beautiful crown moulding is a great way to se...
42    "Minwax Polycrylic Protective Finish is a prot...
43    "The Pink Stella Camellia from the Southern Li...
44    "Your GE 30 in. 5.0 cu. ft. Gas Range with Sel...
45    "Southwires Submersible Pump cable is used sub...
46    "Generacs new Protector Series diesel generato...
47    "The Clearflo Brass Toe-tap bath drain works p...
48    "The Light Kit by Casablanca is a great design...
49    "The Glidden Premium 5-gal. Satin Latex Exteri...
50                       "Paracord is ideal for camping
51    "Crown Bolt's shoulder bolts are also known as...
52    "Wheel Chair Accessible's provide a safe and i...
53    "These wood screws are thread forming screws w...
54    "The Legend Series framed swing stand-alone co...
55    "Create a neat yet stylish storage space for o...
56    "Our Bullnose Adirondack Chair Cushions fit Ad...
57    "Joist hangers are designed to provide support...
58    "These socket cap screws are ideal for applica...
59    "The Bosch quick change bi-metal hole saws fea...
60                                                 None
61    "product_description", Length: 124432, dtype: ...
Name: text, Length: 62, dtype: object
>>> trainDF['text'].shape
(62,)
>>> train_x.shape
(46,)
>>> train_y.shape
(46,)
>>> 
>>> count_vect = CountVectorizer(analyzer='word', token_pattern=r'\w{1,}')
>>> count_vect.fit(trainDF['text'])
CountVectorizer(analyzer='word', binary=False, decode_error='strict',
        dtype=<class 'numpy.int64'>, encoding='utf-8', input='content',
        lowercase=True, max_df=1.0, max_features=None, min_df=1,
        ngram_range=(1, 1), preprocessor=None, stop_words=None,
        strip_accents=None, token_pattern='\\w{1,}', tokenizer=None,
        vocabulary=None)
>>> xtrain_count =  count_vect.transform(train_x)
>>> xvalid_count =  count_vect.transform(valid_x)
>>> tfidf_vect = TfidfVectorizer(analyzer='word', token_pattern=r'\w{1,}', max_features=5000)
>>> tfidf_vect.fit(trainDF['text'])
TfidfVectorizer(analyzer='word', binary=False, decode_error='strict',
        dtype=<class 'numpy.float64'>, encoding='utf-8', input='content',
        lowercase=True, max_df=1.0, max_features=5000, min_df=1,
        ngram_range=(1, 1), norm='l2', preprocessor=None, smooth_idf=True,
        stop_words=None, strip_accents=None, sublinear_tf=False,
        token_pattern='\\w{1,}', tokenizer=None, use_idf=True,
        vocabulary=None)
>>> xtrain_tfidf =  tfidf_vect.transform(train_x)
>>> xvalid_tfidf =  tfidf_vect.transform(valid_x)
>>> tfidf_vect_ngram = TfidfVectorizer(analyzer='word', token_pattern=r'\w{1,}', ngram_range=(2,3), max_features=5000)
>>> tfidf_vect_ngram.fit(trainDF['text'])
TfidfVectorizer(analyzer='word', binary=False, decode_error='strict',
        dtype=<class 'numpy.float64'>, encoding='utf-8', input='content',
        lowercase=True, max_df=1.0, max_features=5000, min_df=1,
        ngram_range=(2, 3), norm='l2', preprocessor=None, smooth_idf=True,
        stop_words=None, strip_accents=None, sublinear_tf=False,
        token_pattern='\\w{1,}', tokenizer=None, use_idf=True,
        vocabulary=None)
>>> xtrain_tfidf_ngram =  tfidf_vect_ngram.transform(train_x)
>>> xvalid_tfidf_ngram =  tfidf_vect_ngram.transform(valid_x)
>>> tfidf_vect_ngram_chars = TfidfVectorizer(analyzer='char', token_pattern=r'\w{1,}', ngram_range=(2,3), max_features=5000)
>>> tfidf_vect_ngram_chars.fit(trainDF['text'])
TfidfVectorizer(analyzer='char', binary=False, decode_error='strict',
        dtype=<class 'numpy.float64'>, encoding='utf-8', input='content',
        lowercase=True, max_df=1.0, max_features=5000, min_df=1,
        ngram_range=(2, 3), norm='l2', preprocessor=None, smooth_idf=True,
        stop_words=None, strip_accents=None, sublinear_tf=False,
        token_pattern='\\w{1,}', tokenizer=None, use_idf=True,
        vocabulary=None)
>>> xtrain_tfidf_ngram_chars =  tfidf_vect_ngram_chars.transform(train_x)
>>> xvalid_tfidf_ngram_chars =  tfidf_vect_ngram_chars.transform(valid_x)
>>> embeddings_index = {}
>>> for i,line in enumerate(open('D:/Spotfire tutorials/wiki-news-300d-1M.vec (1)/data/wiki-news-300d-1M.vec',encoding="utf-8")):
	values = line.split()
	embeddings_index[values[0]] = numpy.asarray(values[1:],dtype='float32')

	
Traceback (most recent call last):
  File "<pyshell#89>", line 1, in <module>
    for i,line in enumerate(open('D:/Spotfire tutorials/wiki-news-300d-1M.vec (1)/data/wiki-news-300d-1M.vec',encoding="utf-8")):
FileNotFoundError: [Errno 2] No such file or directory: 'D:/Spotfire tutorials/wiki-news-300d-1M.vec (1)/data/wiki-news-300d-1M.vec'
>>> for i,line in enumerate(open('D:/Spotfire tutorials/wiki-news-300d-1M.vec (1)/wiki-news-300d-1M.vec',encoding="utf-8")):
	values = line.split()
	embeddings_index[values[0]] = numpy.asarray(values[1:],dtype='float32')

	
>>> token = text.Tokenizer()
>>> token.fit_on_texts(trainDF['text'])
>>> word_index = token.word_index
>>> print("word index",word_index)
word index {'the': 1, 'is': 2, 'in': 3, 'a': 4, 'x': 5, 'ft': 6, 'and': 7, 'with': 8, 'are': 9, '1': 10, '2': 11, 'these': 12, 'to': 13, 'make': 14, 'your': 15, '10': 16, 'of': 17, '4': 18, 'step': 19, 'great': 20, 'for': 21, 'screws': 22, 'premium': 23, 'classic': 24, 'achieving': 25, 'light': 26, 'led': 27, 'house': 28, 'fara': 29, '3': 30, '8': 31, 'metal': 32, 'plastic': 33, 'this': 34, '36': 35, 'cu': 36, 'from': 37, 'back': 38, 'our': 39, '100': 40, 'p': 41, 'designer': 42, 'stylish': 43, 'have': 44, 'thread': 45, 'i': 46, 'crown': 47, '5': 48, 'series': 49, 'ideal': 50, 'chair': 51, 'provide': 52, 'not': 53, 'only': 54, 'do': 55, 'angles': 56, 'joints': 57, 'stronger': 58, 'behr': 59, 'textured': 60, 'deckover': 61, 'an': 62, 'innovati': 63, 'architecture': 64, 'meets': 65, 'contemporary': 66, 'desig': 67, 'grape': 68, 'solar': 69, '265': 70, 'watt': 71, 'polycrystalline': 72, 'pv': 73, 's': 74, 'update': 75, 'bathroom': 76, 'delta': 77, 'vero': 78, 'sing': 79, 'delicious': 80, 'results': 81, 'almost': 82, 'effortl': 83, 'quantum': 84, 'adjustable': 85, 'black': 86, 'emer': 87, 'teks': 88, 'zinc': 89, 'plated': 90, 'steel': 91, 'wa': 92, 'get': 93, 'valley': 94, 'view': 95, 'industries': 96, 'stakes': 97, 'pack': 98, 'recycler': 99, '22': 100, 'personal': 101, 'pace': 102, 'variable': 103, 'speed': 104, '96': 105, 'wide': 106, 'caramel': 107, 'simple': 108, 'weave': 109, 'rollup': 110, 'b': 111, 'insinkerator': 112, 'sinktop': 113, 'switch': 114, 'single': 115, 'outlet': 116, 'rubbermaid': 117, 'folding': 118, 'st': 119, 'backyard': 120, 'scapes': 121, 'grilling': 122, 'handsome': 123, 'fu': 124, 'md': 125, 'building': 126, 'products': 127, 'sprinkler': 128, 'head': 129, 'that': 130, 'fits': 131, 'linear': 132, 'primed': 133, 'mdf': 134, 'ove': 135, 'unique': 136, 'multi': 137, 'color': 138, 'sticks': 139, 'sure': 140, 'installed': 141, 'parks': 142, 'backyards': 143, 'across': 144, 'g': 145, 'samsung': 146, 'front': 147, 'load': 148, 'washer': 149, 'wit': 150, 'quikrete': 151, '80': 152, 'lb': 153, 'crack': 154, 'resistant': 155, 'concrete': 156, 'd': 157, 'smartphones': 158, 'refrigerators': 159, 'everyth': 160, 'save': 161, 'moving': 162, 'easier': 163, 'th': 164, 'sq': 165, 'yorkstone': 166, 'ultratouch': 167, '48': 168, '24': 169, 'radiant': 170, 'barrie': 171, 'reed': 172, 'fencing': 173, 'convenient': 174, 'cost': 175, 'effecti': 176, 'vintage': 177, 'white': 178, 'shelf': 179, 'brackets': 180, 'offer': 181, 'eaton': 182, 'csr': 183, '200': 184, 'amp': 185, 'double': 186, 'pole': 187, 'main': 188, 'breake': 189, 'push': 190, 'nuts': 191, 'no': 192, 'screw': 193, 'but': 194, 'dickies': 195, 'utility': 196, 'knife': 197, 'sheath': 198, 'construct': 199, 'carefree': 200, 'resin': 201, 'durability': 202, 'speakman': 203, 'branded': 204, 'emergency': 205, 'eyewash': 206, 'safety': 207, 'pl': 208, '65111': 209, '01': 210, 'plantronics': 211, 'phone': 212, 'access': 213, "1940's": 214, 'hint': 215, 'today': 216, 'ava': 217, 'up': 218, 'styles': 219, 'superior': 220, 'secur': 221, 'ips': 222, '125': 223, 'psi': 224, 'nsf': 225, 'poly': 226, 'pipe': 227, 'enjoy': 228, 'optimal': 229, 'viewing': 230, 'areas': 231, 'magnavox': 232, 'beautiful': 233, 'moulding': 234, 'way': 235, 'se': 236, 'minwax': 237, 'polycrylic': 238, 'protective': 239, 'finish': 240, 'prot': 241, 'pink': 242, 'stella': 243, 'camellia': 244, 'southern': 245, 'li': 246, 'ge': 247, '30': 248, '0': 249, 'gas': 250, 'range': 251, 'sel': 252, 'southwires': 253, 'submersible': 254, 'pump': 255, 'cable': 256, 'used': 257, 'sub': 258, 'generacs': 259, 'new': 260, 'protector': 261, 'diesel': 262, 'generato': 263, 'clearflo': 264, 'brass': 265, 'toe': 266, 'tap': 267, 'bath': 268, 'drain': 269, 'works': 270, 'kit': 271, 'by': 272, 'casablanca': 273, 'design': 274, 'glidden': 275, 'gal': 276, 'satin': 277, 'latex': 278, 'exteri': 279, 'paracord': 280, 'camping': 281, "bolt's": 282, 'shoulder': 283, 'bolts': 284, 'also': 285, 'known': 286, 'as': 287, 'wheel': 288, "accessible's": 289, 'safe': 290, 'wood': 291, 'forming': 292, 'w': 293, 'legend': 294, 'framed': 295, 'swing': 296, 'stand': 297, 'alone': 298, 'co': 299, 'create': 300, 'neat': 301, 'yet': 302, 'storage': 303, 'space': 304, 'o': 305, 'bullnose': 306, 'adirondack': 307, 'cushions': 308, 'fit': 309, 'ad': 310, 'joist': 311, 'hangers': 312, 'designed': 313, 'support': 314, 'socket': 315, 'cap': 316, 'applica': 317, 'bosch': 318, 'quick': 319, 'change': 320, 'bi': 321, 'hole': 322, 'saws': 323, 'fea': 324, 'none': 325, 'product': 326, 'description': 327, 'length': 328, '124432': 329, 'dtype': 330, 'object': 331}
>>> train_seq_x = sequence.pad_sequences(token.texts_to_sequences(train_x), maxlen=70)
>>> valid_seq_x = sequence.pad_sequences(token.texts_to_sequences(valid_x), maxlen=70)
>>> embedding_matrix = numpy.zeros((len(word_index) + 1, 300))
>>> for word, i in word_index.items():
	embedding_vector = embeddings_index.get(word)
	if embedding_vector is not None:
		embedding_matrix[i] = embedding_vector

		
>>> trainDF['char_count'] = trainDF['text'].apply(len)
>>> trainDF['word_count'] = trainDF['text'].apply(lambda x: len(x.split()))
>>> trainDF['word_density'] = trainDF['char_count'] / (trainDF['word_count']+1)
>>> trainDF['punctuation_count'] = trainDF['text'].apply(lambda x: len("".join(_ for _ in x if _ in string.punctuation)))
>>> trainDF['title_word_count'] = trainDF['text'].apply(lambda x: len([wrd for wrd in x.split() if wrd.istitle()]))
>>> trainDF['upper_case_word_count'] = trainDF['text'].apply(lambda x: len([wrd for wrd in x.split() if wrd.isupper()]))
>>> input_layer = layers.Input((70, ))
>>> embedding_layer = layers.Embedding(len(word_index) + 1, 300, weights=[embedding_matrix], trainable=False)(input_layer)
>>> embedding_layer = layers.SpatialDropout1D(0.3)(embedding_layer)
>>>     lstm_layer = layers.LSTM(100)(embedding_layer)
    
SyntaxError: unexpected indent
>>> lstm_layer = layers.LSTM(100)(embedding_layer)
>>> output_layer1 = layers.Dense(50, activation="relu")(lstm_layer)
>>> output_layer1 = layers.Dropout(0.25)(output_layer1)
>>> def create_rnn_lstm():
	# Add an Input Layer
    input_layer = layers.Input((70, ))

    # Add the word embedding Layer
    embedding_layer = layers.Embedding(len(word_index) + 1, 300, weights=[embedding_matrix], trainable=False)(input_layer)
    embedding_layer = layers.SpatialDropout1D(0.3)(embedding_layer)

    # Add the LSTM Layer
    lstm_layer = layers.LSTM(100)(embedding_layer)

    # Add the output Layers
    output_layer1 = layers.Dense(50, activation="relu")(lstm_layer)
    output_layer1 = layers.Dropout(0.25)(output_layer1)
    output_layer2 = layers.Dense(1, activation="sigmoid")(output_layer1)

    # Compile the model
    model = models.Model(inputs=input_layer, outputs=output_layer2)
    model.compile(optimizer=optimizers.Adam(), loss='binary_crossentropy')
    
    return model

>>> classifier = create_rnn_lstm()
>>> accuracy = train_model(classifier, train_seq_x, train_y, valid_seq_x, is_neural_net=True)
Traceback (most recent call last):
  File "<pyshell#121>", line 1, in <module>
    accuracy = train_model(classifier, train_seq_x, train_y, valid_seq_x, is_neural_net=True)
NameError: name 'train_model' is not defined
>>> def train_model(classifier, feature_vector_train, label, feature_vector_valid, is_neural_net=False):
    # fit the training dataset on the classifier
    classifier.fit(feature_vector_train, label)
    
    # predict the labels on validation dataset
    predictions = classifier.predict(feature_vector_valid)
    
    if is_neural_net:
        predictions = predictions.argmax(axis=-1)
    
    return metrics.accuracy_score(predictions, valid_y)

>>> accuracy = train_model(classifier, train_seq_x, train_y, valid_seq_x, is_neural_net=True)
Epoch 1/1

32/46 [===================>..........] - ETA: 1s - loss: 2.8764
46/46 [==============================] - 3s 61ms/step - loss: 1.9871
>>> print("RNN-LSTM, Word Embeddings",accuracy)
RNN-LSTM, Word Embeddings 0.0625
